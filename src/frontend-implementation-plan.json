{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Guard against admin-token URLs and reinforce canonical share links",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Add a runtime guard that strips `#caffeineAdminToken=...` from the URL and redirects visitors to the canonical `PUBLIC_SITE_URL` to avoid landing on the Caffeine admin/dashboard screen.",
      "acceptanceCriteria": [
        "If `window.location.hash` contains `caffeineAdminToken`, the app removes the hash (using `history.replaceState` or equivalent) and navigates to the clean public URL (`https://npt-for-sunidhi.caffeine.xyz`).",
        "If there is no `caffeineAdminToken` in the hash, the app behavior is unchanged.",
        "The guard does not rely on any backend changes and does not break local development."
      ],
      "file_operations": [
        {
          "path": "frontend/src/utils/adminTokenHashGuard.ts",
          "operation": "create",
          "description": "Create a small runtime helper that detects `caffeineAdminToken` in `window.location.hash`, removes the hash via `history.replaceState`, and (in production) redirects to the canonical `PUBLIC_SITE_URL`, while keeping local development safe (avoid redirecting away from localhost/dev origins)."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the admin-token hash guard to run at startup (early in the existing `useEffect`) so that any visit with `#caffeineAdminToken=...` is immediately cleaned up and routed to the configured `PUBLIC_SITE_URL` without changing behavior for normal visitors."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Update the share-link control UI to warn users not to share admin-token links and ensure copying always uses the canonical `PUBLIC_SITE_URL`.",
      "acceptanceCriteria": [
        "The share control continues to copy exactly `PUBLIC_SITE_URL` (not `window.location.href`).",
        "The UI includes a short English note near the share control clarifying that links containing `#caffeineAdminToken=...` are admin-only and should not be shared.",
        "Copy fallback UI (manual copy input) continues to work as before."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/CopyShareLinkControl.tsx",
          "operation": "modify",
          "description": "Add an always-visible short warning/note near the share button clarifying not to share links containing `#caffeineAdminToken=...`, and reaffirm that the copied link is the canonical public URL from `frontend/src/config/publicSiteUrl.ts`. Keep copy behavior using `PUBLIC_SITE_URL` and preserve the existing fallback manual copy UI. Use existing shadcn-ui `Button` and `Input` components (compose only; do not edit `frontend/src/components/ui`). Verify the component's usage instructions before implementing."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Update the deployment checklist to verify the live visitor URL is hash-free and renders app content, and to remind that admin-token links must not be shared.",
      "acceptanceCriteria": [
        "`frontend/DEPLOYMENT_CHECKLIST.md` includes a step to verify sharing the clean URL `https://npt-for-sunidhi.caffeine.xyz` (with no hash) shows the app content.",
        "Checklist includes a note that admin-token links should never be sent to visitors because they show the Caffeine admin/dashboard screen."
      ],
      "file_operations": [
        {
          "path": "frontend/DEPLOYMENT_CHECKLIST.md",
          "operation": "modify",
          "description": "Extend the checklist with a new verification step to open/share `https://npt-for-sunidhi.caffeine.xyz` with no hash and confirm the app content renders, plus an explicit note that URLs containing `#caffeineAdminToken=...` are admin-only and must never be shared with visitors. Also ensure the markdown remains well-formed (close/complete any incomplete sections as needed)."
        }
      ]
    }
  ]
}